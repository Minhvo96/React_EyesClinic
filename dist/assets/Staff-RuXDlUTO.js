import{c as p,k as Q,l as r,p as Z,x as ee,r as o,i as se,j as e,o as ae,v as le,S as T}from"./index-QqQ6tGiF.js";import{M as j}from"./Modal-29JX4lea.js";import"./setPrototypeOf-qvXEFSTo.js";import"./index-5elrTyU-.js";const g="https://14.225.205.182:8097/api/staffs",I={getAllStaffs:async()=>p.get(g).then(t=>t.data).catch(t=>{console.log(t)}),createStaff:async t=>p.post(g,t).then(n=>n.data).catch(n=>{console.log(n)}),editStaff:async(t,n)=>p.put(g+"/"+n,t).then(c=>c.data).catch(c=>{console.log(c)}),deleteStaff:async t=>p.delete(g+"/"+t).then(n=>n.data).catch(n=>{console.log(n)}),getStaffById:async t=>p.get(g+"/"+t).then(n=>n.data).catch(n=>{console.log(n)})},ne=/image\/(png|jpg|jpeg)/i,te=Q({fullName:r().required("Bạn cần phải cung cấp họ và tên"),address:r().required("Bạn cần phải cung cấp địa chỉ"),phoneNumber:r().required("Bạn cần phải cung cấp số điện thoại").matches(/^(0[0-9]{9})$/,"Số điện thoại không hợp lệ"),degree:r().required("Vui lòng chọn bằng cấp"),role:r().required("Vui lòng chọn vai trò"),experience:Z().required("Vui lòng nhập số năm kinh nghiệm").typeError("Vui lòng nhập số năm kinh nghiệm"),password:r().required("Bạn cần phải nhập mật khẩu"),showPassword:r().required("Hãy xác nhận lại mật khẩu").oneOf([ee("password")],"Mật khẩu không trùng khớp!"),message:r()}),ce=({showModal:t,closeModal:n})=>{var R,C,L,O,F,B,A,_,M,D,$,P,U,q,V,H;const[c,b]=o.useState(!1),[N,S]=o.useState({}),f=()=>{b(!c)},h="https://cdn-icons-png.flaticon.com/512/3031/3031702.png",[v,x]=o.useState(h),l=async i=>{const m=i.target.files[0];if(!m.type.match(ne)){alert("Image mime type is not valid");return}let E,X=!1;if(!m)return;m&&(E=new FileReader,E.onload=k=>{const{result:z}=k.target;z&&!X&&x(z)},E.readAsDataURL(m));const G="dw3x98oui",Y="ml_default",W="https://api.cloudinary.com/v1_1/"+G+"/auto/upload";var w=new FormData;w.append("file",m),w.append("cloud_name",G),w.append("upload_preset",Y);const J=await p({method:"post",url:W,data:w}).then(k=>k.data);S({...N,avatar:J.url})},d=()=>{document.getElementById("img").click()},{register:a,handleSubmit:y,formState:{errors:s},reset:u,setValue:de}=se({resolver:ae(te),mode:"onBlur",criteriaMode:"all"}),K=async i=>{const m={...N,fullName:i.fullName,phoneNumber:i.phoneNumber,address:i.address,experience:i.experience+" năm kinh nghiệm",degree:i.degree,role:i.role,password:i.password,status:"WORKING"};await le.createUser(m),T.fire({position:"center",icon:"success",title:"Tạo nhân viên mới thành công !",showConfirmButton:!1,timer:3500}),u(),n(),x(h)};return e.jsx(e.Fragment,{children:e.jsxs(j,{show:t,onHide:n,size:"lg",centered:!0,children:[e.jsx(j.Header,{closeButton:!0,onClick:()=>{u(),x(h)},children:e.jsx(j.Title,{className:"ms-4",children:"Thêm nhân viên cho phòng khám"})}),e.jsx(j.Body,{children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{children:[e.jsx("div",{className:"text-center mb-5",children:e.jsxs("div",{children:[e.jsx("input",{type:"file",id:"img",name:"img",className:"form-control",onChange:l,hidden:!0}),e.jsx("img",{src:v,alt:"",width:"150px",height:"150px",onClick:d})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Họ và tên"}),e.jsx("input",{type:"text",className:`form-control ${(R=s==null?void 0:s.fullName)!=null&&R.message?"is-invalid":""}`,...a("fullName")}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(C=s==null?void 0:s.fullName)==null?void 0:C.message})]})}),e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Bằng cấp"}),e.jsxs("select",{type:"text",className:`form-control ${(L=s==null?void 0:s.degree)!=null&&L.message?"is-invalid":""}`,...a("degree"),children:[e.jsx("option",{value:"",style:{color:"black"},children:"--Chọn bằng cấp--"}),e.jsxs(e.Fragment,{children:[e.jsx("option",{className:"text-black",value:"UNIVERSITY",children:"Đại học"}),e.jsx("option",{className:"text-black",value:"COLLEGE",children:"Cao đẳng"}),e.jsx("option",{className:"text-black",value:"INTERMEDIATE",children:"Trung cấp"})]})]}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(O=s==null?void 0:s.degree)==null?void 0:O.message})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Địa chỉ"}),e.jsx("input",{type:"text",className:`form-control ${(F=s==null?void 0:s.address)!=null&&F.message?"is-invalid":""}`,...a("address")}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(B=s==null?void 0:s.address)==null?void 0:B.message})]})}),e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Kinh nghiệm"}),e.jsx("input",{type:"number",className:`form-control ${(A=s==null?void 0:s.experience)!=null&&A.message?"is-invalid":""}`,...a("experience")}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(_=s==null?void 0:s.experience)==null?void 0:_.message})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Số điện thoại"}),e.jsx("input",{type:"text",className:`form-control ${(M=s==null?void 0:s.phoneNumber)!=null&&M.message?"is-invalid":""}`,...a("phoneNumber")}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(D=s==null?void 0:s.phoneNumber)==null?void 0:D.message})]})}),e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Vai trò"}),e.jsxs("select",{type:"text",className:`form-control ${($=s==null?void 0:s.role)!=null&&$.message?"is-invalid":""}`,...a("role"),children:[e.jsx("option",{value:"",style:{color:"black"},children:"--Chọn vai trò--"}),e.jsxs(e.Fragment,{children:[e.jsx("option",{className:"text-black",value:"ROLE_DOCTOR",children:"Bác sĩ"}),e.jsx("option",{className:"text-black",value:"ROLE_RECEPTIONIST",children:"Lễ tân"}),e.jsx("option",{className:"text-black",value:"ROLE_ASSISTANT",children:"Trợ lý"}),e.jsx("option",{className:"text-black",value:"ROLE_CASHIER",children:"Thu ngân"})]})]}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(P=s==null?void 0:s.role)==null?void 0:P.message})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Mật khẩu"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:c?"text":"password",className:`form-control ${(U=s==null?void 0:s.password)!=null&&U.message?"is-invalid":""}`,...a("password")}),e.jsx("div",{className:"input-group-append",children:e.jsx("span",{className:"input-group-text",onClick:f,children:e.jsx("i",{className:c?"icon-eye":"icon-eye-slash"})})}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(q=s==null?void 0:s.password)==null?void 0:q.message})]})]})}),e.jsx("div",{className:"mb-3 col-6",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Nhập lại mật khẩu"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:c?"text":"password",className:`form-control ${(V=s==null?void 0:s.showPassword)!=null&&V.message?"is-invalid":""}`,...a("showPassword")}),e.jsx("div",{className:"input-group-append",children:e.jsx("span",{className:"input-group-text",onClick:f,children:e.jsx("i",{className:c?"icon-eye":"icon-eye-slash"})})}),e.jsx("span",{className:"text-danger font-weight-bold invalid-feedback",children:(H=s==null?void 0:s.showPassword)==null?void 0:H.message})]})]})})]})]})})})})})}),e.jsxs(j.Footer,{children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:y(K),children:"Tạo mới"}),e.jsx("button",{onClick:()=>{n(),u(),x(h)},className:"me-4 btn btn-danger",children:"Đóng"})]})]})})},ie=ce;function xe(){const[t,n]=o.useState(!1),[c,b]=o.useState([]),[N,S]=o.useState(!0),f=()=>{n(!0)},h=()=>{n(!1)},v=async()=>{const d=(await I.getAllStaffs()).filter(a=>a.role!=="ROLE_ADMIN");d.forEach(a=>{a.role=="ROLE_DOCTOR"&&(a.role="Bác sĩ"),a.role=="ROLE_RECEPTIONIST"&&(a.role="Lễ tân"),a.role=="ROLE_ASSISTANT"&&(a.role="Phụ tá"),a.role=="ROLE_CASHIER"&&(a.role="Thu ngân"),a.degree=="UNIVERSITY"&&(a.degree="Đại học"),a.degree=="COLLEGE"&&(a.degree="Cao đẳng"),a.degree=="INTERMEDIATE"&&(a.degree="Trung cấp")}),b(d),S(!1)};o.useEffect(()=>{v()},[]),o.useEffect(()=>{v()},[t]);const x=l=>{T.fire({title:"Bạn chắc chắn muốn xóa nhân viên này?",showCancelButton:!0,confirmButtonText:"Xóa",cancelButtonText:"Không"}).then(async d=>{if(d.isConfirmed){const y={...await I.getStaffById(l),status:"LAYOFF"};await I.editStaff(y,l),T.fire("Xóa thành công!","","success"),b(s=>s.filter(u=>u.id!==l))}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"card-title fw-semibold mb-4",children:"Danh sách nhân viên"}),e.jsxs("div",{className:"d-flex align-items-center mb-4",style:{cursor:"pointer"},onClick:()=>f(),children:[e.jsx("button",{className:"btn btn-primary d-flex align-items-center justify-content-center",style:{borderRadius:"50%",width:"32px",height:"32px"},children:e.jsx("i",{className:"ti ti-plus text-center",style:{fontSize:"16px"}})}),e.jsx("p",{className:"mb-0 fw-normal link-primary",style:{marginLeft:"10px"},children:"Thêm nhân viên"})]})]})}),N?e.jsx("span",{className:"loader"}):e.jsx("div",{className:"col-lg-12 d-flex align-items-around",style:{padding:0},children:e.jsxs("div",{className:"card w-100",children:[e.jsxs("div",{className:"d-flex ps-4 pt-4",children:[e.jsx("span",{className:"h5 fw-semibold",children:c.length}),e.jsx("p",{className:"ms-1 fw-normal",children:"nhân viên"})]}),e.jsx("div",{className:"card-body p-4",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table text-nowrap mb-0 align-middle",children:[e.jsx("thead",{className:"text-dark fs-4 text-center",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"STT"})}),e.jsx("th",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Ảnh"})}),e.jsx("th",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Họ và tên"})}),e.jsx("th",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Số điện thoại"})}),e.jsx("th",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Chức vụ"})}),e.jsx("th",{className:"border-bottom-0 text-center",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Bằng cấp"})}),e.jsx("th",{className:"border-bottom-0 text-center",children:e.jsx("h6",{className:"fw-semibold mb-0",children:"Xóa"})})]})}),e.jsx("tbody",{className:"text-center",children:c.length>0&&c.map((l,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-1",children:d+1})}),e.jsx("td",{className:"border-bottom-0",children:e.jsx("img",{src:l.avatar,alt:"",style:{width:50}})}),e.jsx("td",{className:"border-bottom-0",children:e.jsx("h6",{className:"fw-semibold mb-0",children:l==null?void 0:l.fullName})}),e.jsx("td",{className:"border-bottom-0",children:e.jsx("p",{className:"mb-0 fw-normal",children:l==null?void 0:l.phoneNumber})}),e.jsx("td",{className:"border-bottom-0",children:e.jsx("p",{className:"mb-0 fw-normal",children:l==null?void 0:l.role})}),e.jsx("td",{className:"border-bottom-0 text-center",children:e.jsx("p",{className:"mb-0 fw-normal",children:l==null?void 0:l.degree})}),e.jsx("td",{className:"border-bottom-0",children:e.jsx("div",{className:"d-flex align-items-center justify-content-center",children:e.jsx("button",{className:"btn btn-outline-danger d-flex align-items-center justify-content-center",style:{width:"36px",height:"36px"},onClick:()=>x(l.id),children:e.jsx("i",{className:"ti ti-trash",style:{fontSize:"18px"}})})})})]},l.id))})]})})})]})})]}),e.jsx(ie,{showModal:t,closeModal:h})]})}export{xe as default};
